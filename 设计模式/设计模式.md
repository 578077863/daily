# 设计模式

策略模式Strategy（对象行为型）

我们去旅行。策略模式的做法：有几种方案供你选择旅行，选择火车好呢还是骑自行车，完全有客户自行决定去构建旅行方案（比如你自己需要去买火车票，或者机票）。而工厂模式是你决定哪种旅行方案后，不用关注这旅行方案怎么给你创建，也就是说你告诉我方案的名称就可以了，然后由工厂代替你去构建具体方案（工厂代替你去买火车票）。



**定**义一系列的算法,把每一个算法封装起来, 并且使它们可相互替换。本模式使得算法可独立于使用它的客户而变化。



本人理解：

存在多个继承同一个基类的实现类，在客户端通过switch选择某一个子类创建并调用基类定义的方法以此实现客户想要进行的行为。



简单点说就是多个类都实现了父类的方法，只是执行逻辑不同而已，所以在不同场景下可以相互替换，交由客户来选择。



优点：

1. 可以自由切换算法
2. 避免使用多重条件判断（使用if（）else if（）之类来选择算法这样的）
3. 扩展性好（不影响其他代码，只需增加就行）



缺点：

1. 策略类会增多
2. 所有策略类都需要对外暴露





## 封装、抽象、继承、多态分别可以解决哪些编程问题？



### 封装（Encapsulation）

封装特性。封装也叫作信息隐藏或者数据访问保护。类通过暴露有限的访问 接口，授权外部仅能通过类提供的方式（或者叫函数）来访问内部信息或者数据

对于封装这个特性，我们需要编程语言本身提供一定的语法机制来支持。这个语法机制就是 访问权限控制



**封装特性的定义讲完了，我们再来看一下，封装的意义是什么？它能解决什么编程问题？**

如果我们对类中属性的访问不做限制，那任何代码都可以访问、修改类中的属性，虽然这样看起来更加灵活，但从另一方面来说，过度灵活也意味着不可控，属性可以随意被以各种奇葩的方式修改，而且修改逻辑可能散落在代码中的各个角落，势必**影响代码的可读性、可维护性**。

除此之外，**类仅仅通过有限的方法暴露必要的操作，也能提高类的易用性**。如果我们把类属性都暴露给类的调用者，调用者想要正确地操作这些属性，就势必要对业务细节有足够的了 解。而这对于调用者来说也是一种负担。相反，如果我们将属性封装起来，暴露少许的几个必要的方法给调用者使用，调用者就不需要了解太多背后的业务细节，用错的概率就减少很多



封装主要讲的是如何隐藏信息、保护数据，而抽象讲的是如何隐藏方法的具体实现，让调用者只需要关心方法提供了哪些功能，并不需要知道这些功能是如何实现的。



### 抽象（Abstraction）

在面向对象编程中，我们常借助编程语言提供的接口类（比如 Java 中的 interface 关键字 语法）或者抽象类（比如 Java 中的 abstract 关键字语法）这两种语法机制，来实现抽象这一特性。



我们利用 Java 中的 interface 接口语法来实现抽象特性。调用者在 使用图片存储功能的时候，只需要了解 IPictureStorage 这个接口类暴露了哪些方法就可以 了，不需要去查看 PictureStorage 类里的具体实现逻辑。

实际上，抽象这个特性是非常容易实现的，并不需要非得依靠接口类或者抽象类这些特殊语 法机制来支持。换句话说，并不是说一定要为实现类（PictureStorage）抽象出接口类 （IPictureStorage），才叫作抽象

类的方法是通过编程语言中的“函数”这一语法机制来实现的。 通过函数包裹具体的实现逻辑，这本身就是一种抽象。调用者在使用函数的时候，并不需要去研究函数内部的实现逻辑，只需要通过函数的命名、注释或者文档，了解其提供了什么功能，就可以直接使用了。



抽象有时候会被排除在面向对象的四大特性之外， 当时我卖了一个关子，现在我就来解释一下为什么。

抽象这个概念是一个非常通用的设计思想，并不单单用在面向对象编程中，也可以用来指导 架构设计等。而且这个特性也并不需要编程语言提供特殊的语法机制来支持，只需要提 供“函数”这一非常基础的语法机制，就可以实现抽象特性、所以，它没有很强的“特异 性”，有时候并不被看作面向对象编程的特性之一。



**抽象特性的定义讲完了，我们再来看一下，抽象的意义是什么？它能解决什么编程问题？**

实际上，如果上升一个思考层面的话，抽象及其前面讲到的封装都是人类**处理复杂性的有效手段**。在面对复杂系统的时候，人脑能承受的信息复杂程度是有限的，所以我们必须忽略掉 一些非关键性的实现细节。而抽象作为一种只关注功能点不关注实现的设计思路，正好帮我 们的大脑过滤掉许多非必要的信息。

除此之外，抽象作为一个非常宽泛的**设计思想**，在代码设计中，起到非常重要的指导作用。 很多设计原则都体现了抽象这种设计思想，比如基于接口而非实现编程、开闭原则（对扩展 开放、对修改关闭）、代码解耦（降低代码的耦合性）等

换一个角度来考虑，我们在定义（或者叫命名）类的方法的时候，也要有抽象思维，不要在 方法定义中，暴露太多的实现细节，以保证在某个时间点需要改变方法的实现逻辑的时候， 不用去修改其定义。





### 继承（Inheritance）

继承是用来表示类之间的 is-a 关系，比如猫是一种哺乳动物。从继承关系上来讲，继承可以分为两种模式，单继承 和多继承。



**继承特性的定义讲完了，我们再来看，继承存在的意义是什么？它能解决什么编程问题？**

继承最大的一个好处就是代码复用。假如两个类有一些相同的属性和方法，我们就可以将这 些相同的部分，抽取到父类中，让两个子类继承父类。这样，两个子类就可以重用父类中的 代码，避免代码重复写多遍。不过，这一点也并不是继承所独有的，我们也可以通过其他方 式来解决这个代码复用的问题，比如利用组合关系而不是继承关系。

继承的概念很好理解，也很容易使用。不过，过度使用继承，继承层次过深过复杂，就会导 致代码可读性、可维护性变差。为了了解一个类的功能，我们不仅需要查看这个类的代码， 还需要按照继承关系一层一层地往上查看“父类、父类的父类……”的代码。还有，子类和 父类高度耦合，修改父类的代码，会直接影响到子类。





### 多态（Polymorphism）

多态这种特性也需要编程语言提供特殊的语法机制来实现:

* 第一个语法机制是编程语言要支持父类对象可以引用子类对象
* 第二个语法机制是编程语言要支持继承
* 第三个语法机制是编程语言要支持子类可以重写（override）父类中的方法



对于多态特性的实现方式，除了利用“继承加方法重写”这种实现方式之外，我们还有其他 两种比较常见的的实现方式，一个是利用接口类语法，另一个是利用 duck-typing 语法。 不过，并不是每种编程语言都支持接口类或者 duck-typing 这两种语法机制，比如 C++ 就不支持接口类语法，而 duck-typing 只有一些动态语言才支持，比如 Python、 JavaScript 等。

* 何利用接口类来实现多态特性
* duck-typing 实现多态的方式非常灵活。Logger 和 DB 两个类 没有任何关系，既不是继承关系，也不是接口和实现的关系，但是只要它们都有定义了 record() 方法，就可以被传递到 test() 方法中，在实际运行的时候，执行对应的 record() 方法。也就是说，只要两个类具有相同的方法，就可以实现多态，并不要求两个类之间有任何关 系，这就是所谓的 duck-typing，是一些动态语言所特有的语法机制。而像 Java 这样的静 态语言，通过继承实现多态特性，必须要求两个类之间有继承关系，通过接口实现多态特 性，类必须实现对应的接口。



**多态特性讲完了，我们再来看，多态特性存在的意义是什么？它能解决什么编程问题？**

1. 多态特性能提高代码的可扩展性和复用性

   利用多态的特性，**仅用一个 print() 函数就可以实现遍历打印不同类型 （Array、LinkedList）集合的数据**。当再增加一种要遍历打印的类型的时候，比如 HashMap，我们只需让 HashMap 实现 Iterator 接口，重新实现自己的 hasNext()、next() 等方法就可以了，**完全不需要改动print() 函数的代码**。所以说，多态提高了代码的 可扩展性。如果我们不使用多态特性，我们就无法将不同的集合类型（Array、LinkedList）传递给相 同的函数（print(Iterator iterator) 函数）。我们需要针对每种要遍历打印的集合，分别实 现不同的 print() 函数，比如针对 Array，我们要实现 print(Array array) 函数，针对 LinkedList，我们要实现 print(LinkedList linkedList) 函数。而利用多态特性，我们**只需要 实现一个 print() 函数的打印逻辑，就能应对各种集合数据的打印操作，这显然提高了代码的复用性。**

2. 除此之外，多态也是很多设计模式、设计原则、编程技巧的代码实现基础，比如策略模式、 基于接口而非实现编程、依赖倒置原则、里式替换原则、利用多态去掉冗长的 if-else 语句



### 总结与问答

```markdown
1. 关于封装特性
封装也叫作信息隐藏或者数据访问保护。类通过暴露有限的访问接口，授权外部仅能通过类提供的方式来访问内部信息或者数据。它需要编程语言提供权限访问控制语法来支持，例如Java 中的 private、protected、public 关键字。封装特性存在的意义，一方面是保护数据不被随意修改，提高代码的可维护性；另一方面是仅暴露有限的必要接口，提高类的易用性。

2. 关于抽象特性
封装主要讲如何隐藏信息、保护数据，那抽象就是讲如何隐藏方法的具体实现，让使用者只需要关心方法提供了哪些功能，不需要知道这些功能是如何实现的。抽象可以通过接口类或者抽象类来实现，但也并不需要特殊的语法机制来支持。抽象存在的意义，一方面是提高代码的可扩展性、维护性，修改实现不需要改变定义，减少代码的改动范围；另一方面，它也是处理复杂系统的有效手段，能有效地过滤掉不必要关注的信息。

3. 关于继承特性
继承是用来表示类之间的 is-a 关系，分为两种模式：单继承和多继承。单继承表示一个子类只继承一个父类，多继承表示一个子类可以继承多个父类。为了实现继承这个特性，编程语言需要提供特殊的语法机制来支持。继承主要是用来解决代码复用的问题。

4. 关于多态特性
多态是指子类可以替换父类，在实际的代码运行过程中，调用子类的方法实现。多态这种特性也需要编程语言提供特殊的语法机制来实现，比如继承、接口类、duck-typing。多态可以提高代码的扩展性和复用性，是很多设计模式、设计原则、编程技巧的代码实现基础。
```



```markdown
你熟悉的编程语言是否支持多重继承？如果不支持，请说一下为什么不支持。如果支持，请说一下它是如何避免多重继承的副作用的

首先java类支持多继承的话，两个父类有同名方法，在子类中调用的时候就不知道调用哪个了，出现决议(钻石问题或菱形问题)问题而接口支持多继承因为接口定义的方法不能有方法体，所以不会出现决议问题。
```







## 面向对象相比面向过程有哪些优势？面向过程真的过时 了吗？
